import{k as o,o as i,c as d,a as _,f as p}from"./vendor.4811b7c0.js";import{_ as a,T as h}from"./index.dee0a948.js";const l={name:"TuneDisplay",mixins:[h],inject:["context"],data(){return{abcjs:o}},computed:{tune(){var e;return(e=this.context)==null?void 0:e.selectedTune},transformedAbc(){return this.transformAbc(this.tune.abc)},transpose(){var e,t;return(t=(e=this.context)==null?void 0:e.settings)==null?void 0:t.transpose},tablature(){var e,t;return(t=(e=this.context)==null?void 0:e.settings)==null?void 0:t.showTabs}},watch:{tune(){this.renderTune()},transpose(){this.renderTune()},tablature(){this.renderTune()}},mounted(){this.renderTune(),this.$bus.emit("setNotationContainer",this.$refs.render)},methods:{renderTune(){var n,s,r;if(!this.tune||!((n=this.$refs)==null?void 0:n.render))return;const e=this.tablature?[{instrument:"violin"}]:[],t=o.renderAbc(this.$refs.render,this.transformedAbc,{add_classes:!0,responsive:"resize",clickListener:this.seekTo,visualTranspose:(r=(s=this==null?void 0:this.context)==null?void 0:s.settings)==null?void 0:r.transpose,tablature:e});this.$bus.emit("setRenderedTune",t)},transformAbc(e){const t=["title","type","notes","composer","source","transcription"];return this.TuneData_getMetaFieldRegexStringsByKeys(...t).forEach(s=>{e=e.replace(new RegExp(`${s}
`,"g"),"")}),e},seekTo(e){if(e.el_type!=="note")return;const t=e.currentTrackMilliseconds;this.$bus.emit("seek",t)}}},m={class:"tune"},T={ref:"render",class:"notation"};function f(e,t,n,s,r,c){return i(),d("div",m,[_("div",T,null,512)])}var $=a(l,[["render",f],["__scopeId","data-v-e4d8b008"]]);const x={name:"Tune",inject:["tunes"],props:["name"],computed:{tune(){return this.tunes[this.name]}},watch:{tune(e){this.select(e)}},mounted(){this.select(this.tune)},methods:{select(e){this.$bus.emit("selectTune",e)}}};function b(e,t,n,s,r,c){const u=$;return i(),p(u)}var k=a(x,[["render",b]]);export{k as default};
